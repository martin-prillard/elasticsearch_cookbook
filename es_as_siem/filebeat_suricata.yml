filebeat.inputs:
- type: filestream
  id: suricata-eve
  enabled: true
  paths:
  - /var/log/suricata/eve.json
  parsers:
  - ndjson:
      keys_under_root: true
      add_error_key: true
      message_key: message
  fields:
    log_type: suricata
  fields_under_root: false
  # Désactiver les data streams pour cet input
  data_stream:
    enabled: false
output.elasticsearch:
  hosts:
  - https://es01:9200
  index: "suricata-%{+yyyy.MM.dd}"
  username: elastic
  password: ${ELASTICSEARCH_PASSWORD}
  ssl:
    certificate_authorities:
    - /usr/share/filebeat/config/certs/ca/ca.crt
    verification_mode: certificate
  # Désactiver les data streams pour utiliser des index normaux
  data_stream:
    enabled: false
setup.template.name: suricata
setup.template.pattern: suricata-*
setup.template.settings:
  index.number_of_shards: 1
  index.codec: best_compression
processors:
- timestamp:
    field: timestamp
    layouts:
    - 2006-01-02T15:04:05.000000-0700
    - '2006-01-02T15:04:05.000000Z'
    - '2006-01-02T15:04:05Z'
    test:
    - '2024-01-15T10:30:45.123456Z'
